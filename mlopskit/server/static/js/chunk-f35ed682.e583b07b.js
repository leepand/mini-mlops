(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f35ed682"],{"33a1":function(e,t,a){},4928:function(e,t,a){e.exports=a.p+"img/icon-yes.d2f9f035.svg"},"6ceb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticStyle:{"margin-left":"15px","margin-right":"15px","margin-top":"15px"}},[s("el-divider"),s("el-descriptions",{staticClass:"margin-top",attrs:{title:"",column:3,size:e.size}},[s("template",{slot:"title"},[s("span",[e._v(e._s(e.regedModelVersion.name))])]),s("template",{slot:"extra"},["all"===e.firstID?s("router-link",{staticStyle:{"text-decoration":"none",color:"aliceblue"},attrs:{to:{name:"模型版本管理",params:{model_name:this.$route.params.model_name}}}},[s("el-button",{staticClass:"return-list"},[s("i",{staticClass:"el-icon-arrow-left",staticStyle:{"margin-right":"5px"}}),e._v("返回模型版本管理")])],1):e._e()],1),s("el-descriptions-item",{attrs:{label:"模型版本"}},[e._v(e._s(e.regedModelVersion.version))]),s("el-descriptions-item",{attrs:{label:"创建时间"}},[s("timeago",{attrs:{datetime:e.regedModelVersion.creation_timestamp,locale:"zh-CN"}})],1),s("el-descriptions-item",{attrs:{label:"最近修改时间"}},[s("timeago",{attrs:{datetime:e.regedModelVersion.last_updated_timestamp,locale:"zh-CN"}})],1),s("el-descriptions-item",{attrs:{label:"Stage"}},[s("el-dropdown",{on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[s("el-tag",{attrs:{type:e.curr_stage_style,size:"small"}},[e._v(e._s(e.regedModelVersion.current_stage))]),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:e.stag_act1}},[e._v("转换为"),s("i",{staticClass:"el-icon-right",staticStyle:{"margin-right":"5px","margin-left":"5px"}}),s("el-tag",{attrs:{type:e.stag_act1_style,size:"small"}},[e._v(e._s(e.stag_act1))])],1),s("el-dropdown-item",{attrs:{command:e.stag_act2}},[e._v("转换为"),s("i",{staticClass:"el-icon-right",staticStyle:{"margin-right":"5px","margin-left":"5px"}}),s("el-tag",{attrs:{type:e.stag_act2_style,size:"small"}},[e._v(e._s(e.stag_act2))])],1),s("el-dropdown-item",{attrs:{command:e.stag_act3}},[e._v("转换为"),s("i",{staticClass:"el-icon-right",staticStyle:{"margin-right":"5px","margin-left":"5px"}}),s("el-tag",{attrs:{type:e.stag_act3_style,size:"small"}},[e._v(e._s(e.stag_act3))])],1)],1)],1)],1),s("el-descriptions-item",{attrs:{label:"Source Run"}},[s("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"模型实验详情",params:{run_id:e.regedModelVersion.run_id}}}},[e._v(e._s(e.regedModelVersion.run_id)+"\n      ")])],1)],2),s("el-collapse",{staticStyle:{"margin-bottom":"20px"},on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"模型版本描述",name:"1"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.descvisalble,expression:"descvisalble"}]},[e._v(e._s(e.regedModelVersion.description)+"  ")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.descvisalble,expression:"descvisalble"}],attrs:{type:"text"},on:{click:e.handleEdit}},[s("i",{staticClass:"el-icon-edit"})]),s("el-input",{directives:[{name:"show",rawName:"v-show",value:e.descEditable,expression:"descEditable"}],staticStyle:{width:"60%"},attrs:{type:"textarea",rows:3},model:{value:e.editModelVersionMeta.description,callback:function(t){e.$set(e.editModelVersionMeta,"description",t)},expression:"editModelVersionMeta.description"}}),s("div",[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.descEditable,expression:"descEditable"}],staticStyle:{"margin-right":"0px"},attrs:{type:"text",icon:"el-icon-arrow-left"},on:{click:e.handelCancel}},[e._v("取消")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.descEditable,expression:"descEditable"}],staticStyle:{align:"right"},attrs:{type:"text",icon:"el-icon-check",circle:""},on:{click:e.submitSave}},[e._v("保存")])],1)],1),s("el-collapse-item",{attrs:{title:"模型版本代码及工件",name:"2"}},[s("el-card",{staticClass:"box-card"},[s("el-row",{staticClass:"dynamic-manage"},[s("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"10px"},attrs:{span:24}},[s("el-radio-group",{staticStyle:{float:"right","margin-left":"50px"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{data:e.pathParam,action:e.uploadURL,"on-success":e.handleUploadSuccess,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1,clearFiles:""}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.lookdir,expression:"lookdir"}],attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.lookdir,expression:"lookdir"}],staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传到模型空间")]),s("el-button",{style:e.back_display,attrs:{size:"small"},on:{click:e._back}},[s("i",{staticClass:"el-icon-d-arrow-left",staticStyle:{"margin-left":"5px"}}),e._v("返回\n                ")])],1)],1)],1),s("el-card",{directives:[{name:"show",rawName:"v-show",value:e.lookfilecontent,expression:"lookfilecontent"}],attrs:{shadow:"never"}},[s("div",{domProps:{innerHTML:e._s(e.file_content)}})]),s("el-col",{directives:[{name:"show",rawName:"v-show",value:e.lookdir,expression:"lookdir"}],attrs:{span:24}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.files,stripe:""}},[s("el-table-column",{attrs:{type:"index",label:"#","min-width":"10%"}}),s("el-table-column",{attrs:{prop:"name",label:"文件名称","min-width":"18%"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.is_dir?s("el-button",{attrs:{icon:"fa fa-folder-o",type:"text",size:"big"},on:{click:function(a){return e.handleFileDir(t.$index,t.row)}}},[e._v(" "+e._s(t.row.name)+"/\n                  ")]):e._e(),!1===t.row.is_dir?s("el-button",{attrs:{icon:"fa fa-file-o",type:"text",size:"big"},on:{click:function(a){return e.handleCatFileName(t.$index,t.row)}}},[e._v("\n                    "+e._s(t.row.name)+"\n                  ")]):e._e()]}}])}),s("el-table-column",{attrs:{prop:"size",label:"大小","min-width":"10%"}}),s("el-table-column",{attrs:{prop:"last_modified",label:"上次修改时间","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("timeago",{attrs:{datetime:e.row.last_modified,locale:"zh-CN"}})]}}])}),s("el-table-column",{staticStyle:{float:"right"},attrs:{prop:"description",label:"","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-dropdown",{staticClass:"editGroup",staticStyle:{"margin-right":"1%"},attrs:{trigger:"hover"}},[s("i",{staticClass:"el-icon-more"}),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{nativeOn:{click:function(a){return e.handleDelFileDir(t.row.is_dir,t.row.name)}}},[e._v("删除")]),s("el-dropdown-item",{nativeOn:{click:function(a){return e.handleEditFileName(t.row.is_dir,t.row.name)}}},[e._v("重命名")]),!1===t.row.is_dir?s("el-dropdown-item",{nativeOn:{click:function(a){return e.handleCatFileName(t.row.is_dir,t.row)}}},[e._v("查看")]):e._e()],1)],1)]}}])})],1),s("el-col",{directives:[{name:"show",rawName:"v-show",value:e.lookdir,expression:"lookdir"}],attrs:{span:24}},[s("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,"page-count":e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1),s("br"),s("br")],1)],1),s("el-collapse-item",{attrs:{title:"模型监控",name:"3"}},[s("el-row",[s("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[s("div",{staticStyle:{display:"flex","align-content":"center"}},[s("el-radio-group",{staticStyle:{"margin-bottom":"10px"},model:{value:e.isall,callback:function(t){e.isall=t},expression:"isall"}},[s("el-radio-button",{attrs:{label:"all"}},[s("span",[e._v(e._s(e.all_predict_btn))])]),s("el-radio-button",{attrs:{label:"errors"}},[s("span",[e._v(e._s(e.errors_btn))])]),s("el-radio-button",{attrs:{label:"sql"}},[e._v("SQLView")])],1),s("el-select",{directives:[{name:"show",rawName:"v-show",value:e.showsql,expression:"showsql"}],staticStyle:{"margin-left":"5px"},attrs:{placeholder:"数据表"},model:{value:e.mltable,callback:function(t){e.mltable=t},expression:"mltable"}},e._l(e.dataEngines,(function(e,t){return s("el-option",{key:t+"",attrs:{label:e,value:e}})})),1)],1)])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showsql,expression:"showsql"}],staticStyle:{margin:"0px"}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules}},[s("div",{staticStyle:{border:"1px solid #e6e6e6","margin-bottom":"12px",padding:"15px","padding-bottom":"75px"}},[s("h3",{staticStyle:{display:"flex"},attrs:{id:"sql"}},[s("span",{staticStyle:{float:"left"}},[e._v("\n              Query\n            ")]),s("el-col",{staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[s("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{type:"primary",size:"small"},on:{click:e.tableDefine}},[e._v("+/- Table definition")]),s("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{type:"primary",size:"small"},on:{click:e.PlotMonitorData}},[e._v("+ Plot")]),s("el-button",{staticStyle:{float:"right","margin-left":"5px"},attrs:{type:"success",size:"small",icon:"el-icon-s-operation"},on:{click:e.FormatSqlScript}},[e._v("FormatSql")])],1)],1),s("el-card",{directives:[{name:"show",rawName:"v-show",value:e.monitorPlotShow,expression:"monitorPlotShow"}],staticStyle:{"margin-bottom":"10px"}},[s("el-row",{staticClass:"topmargin",attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("el-row",{staticStyle:{"margin-bottom":"10px",display:"flex","align-content":"center"}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("X")])]),s("el-col",{attrs:{span:12}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择数据"},model:{value:e.Xlable,callback:function(t){e.Xlable=t},expression:"Xlable"}},e._l(e.Xs,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),s("el-row",{staticStyle:{display:"flex","align-content":"center"}},[s("el-col",{attrs:{span:3}},[s("span",[e._v("Y")])]),s("el-col",{attrs:{span:12}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择数据"},model:{value:e.Ylable,callback:function(t){e.Ylable=t},expression:"Ylable"}},e._l(e.Ys,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),s("el-col",{attrs:{span:12}},[s("div",{staticStyle:{width:"700px",height:"250px",float:"center"},attrs:{id:"tester"}})])],1)],1),s("p",{directives:[{name:"show",rawName:"v-show",value:e.table_define_display,expression:"table_define_display"}],domProps:{innerHTML:e._s(e.table_structure)}}),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:24}},[s("el-form-item",{attrs:{prop:"sqlScript"}},[s("el-input",{staticClass:"highlight",attrs:{type:"textarea",autosize:{minRows:5,maxRows:200},placeholder:"SELECT * 'predictions'","auto-complete":""},model:{value:e.form.sqlScript,callback:function(t){e.$set(e.form,"sqlScript",t)},expression:"form.sqlScript"}})],1)],1),s("el-col",{attrs:{span:24}},[s("el-button",{attrs:{type:"primary",loading:e.sqlScriptSend},on:{click:e.sqlExecute}},[e._v("执行")]),s("el-button",{attrs:{type:"success",loading:e.sqlScriptSave},on:{click:e.sqlSave}},[e._v("保存查询语句")]),s("el-dropdown",{staticStyle:{"margin-left":"10px","margin-right":"10px"},on:{command:e.handleCommandDownload}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.afterrun,expression:"afterrun"}],attrs:{type:"danger"}},[e._v("\n                    下载查询结果"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"json",icon:"el-icon-download"}},[e._v("JSON 格式")]),s("el-dropdown-item",{attrs:{command:"csv",icon:"el-icon-download"}},[e._v("CSV 格式")])],1)],1),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.afterrun,expression:"afterrun"}],attrs:{type:"danger",loading:e.dropTableLoading},on:{click:e.DropTable}},[e._v("删除表"+e._s(e.tableName))])],1)],1)],1)]),s("h3",{attrs:{id:"sql"}},[e._v("Results("+e._s(e.query_data_len)+")")]),s("el-table",{ref:"multipleHeadTable",attrs:{data:e.tableData,"highlight-current-row":""}},e._l(e.tableHeader,(function(t,a){return s("el-table-column",{key:t,attrs:{label:t[0],align:"center","render-header":e.labelHead},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row[a])+"\n            ")]}}],null,!0)})})),1)],1),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showmoni,expression:"showmoni"}]},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoadingMonitor,expression:"listLoadingMonitor"}],staticStyle:{width:"100%"},attrs:{data:e.modelPredictions,"highlight-current-row":""},on:{"selection-change":e.selsChange2}},[s("el-table-column",{attrs:{type:"index",label:"#","min-width":"5%"}}),s("el-table-column",{attrs:{prop:"request_id",label:"request id","min-width":"10%"}}),s("el-table-column",{attrs:{prop:"experiment",label:"experiment","min-width":"15%",sortable:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("img",{directives:[{name:"show",rawName:"v-show",value:t.row.status,expression:"scope.row.status"}],attrs:{src:a("4928")}}),e._v("\n              "+e._s(t.row.experiment)+"\n            ")]}}])}),s("el-table-column",{attrs:{prop:"created_at",label:"created at","min-width":"10%",sortable:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(e){return[s("timeago",{attrs:{datetime:e.row.created_at,locale:"zh-CN"}})]}}])}),s("el-table-column",{attrs:{prop:"alternative",label:"alternative","min-width":"10%",sortable:"","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"predict_type",label:"model type","min-width":"10%",sortable:"","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"log_type",label:"log type","min-width":"10%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return["errors"===t.row.log_type?s("el-tag",{attrs:{type:"danger"}},[e._v(e._s(t.row.log_type))]):"rewards"===t.row.log_type?s("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.row.log_type))]):s("el-tag",{attrs:{type:"info"}},[e._v(e._s(t.row.log_type))])]}}])}),s("el-table-column",{attrs:{prop:"content",label:"content","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[""===t.row.content?s("span",[e._v("无")]):s("span",[e._v(e._s(t.row.content))])]}}])})],1),s("el-col",{staticClass:"toolbar",attrs:{span:24}},[s("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,"page-count":e.total_pred},on:{"current-change":e.handleCurrentChange2}})],1)],1)],1)],1),s("el-dialog",{staticStyle:{width:"60%",left:"20%"},attrs:{title:e.rename_tile_type,visible:e.editFileNameFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFileNameFormVisible=t}}},[s("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"重要提示",type:"warning",closable:"flase",description:"重命名文件将切断与其版本历史的联系--版本历史将与旧文件名一起保存，您将无法比较修订","show-icon":""}}),s("el-form",{ref:"editFileNameForm",attrs:{model:e.editFileNameForm,"label-width":"80px",rules:e.editFileNameFormRules}},[s("el-form-item",{attrs:{label:"新名称",prop:"newName"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editFileNameForm.newName,callback:function(t){e.$set(e.editFileNameForm,"newName","string"===typeof t?t.trim():t)},expression:"editFileNameForm.newName"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{nativeOn:{click:function(t){e.editFileNameFormVisible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",loading:e.editFileNameLoading},nativeOn:{click:function(t){return e.editFileNameSubmit(t)}}},[e._v("提交")])],1)],1),s("el-dialog",{attrs:{title:e.delTitle,width:"30%",visible:e.delFileDirVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.delFileDirVisible=t}}},[s("el-divider"),s("div",{staticStyle:{"font-size":"15px"}},[s("el-row",{staticStyle:{margin:"10px"},attrs:{gutter:20}},[s("span",[e._v(e._s(e.tobeDelFileDir))])])],1),s("el-divider"),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{nativeOn:{click:function(t){e.delFileDirVisible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",loading:e.delFileDirLoading},nativeOn:{click:function(t){return e.delFileDirSubmit(t)}}},[e._v("提交")])],1)],1),s("br")],1)},i=[],o=(a("c5f6"),a("7f7f"),a("ac6a"),a("c14d"),a("313e")),l=a("4ec3"),n=a("1157"),r=a.n(n),c=a("c1df"),d=a.n(c),m={data:function(){return{sqlScriptSend:!1,sqlScriptSave:!1,afterrun:!1,dataX:[],legendY:[],dataY:[],monitorPlotShow:!1,Xs:[],Ys:[],Xlable:[],Ylable:[],tableName:"predictions",mltable:"",query_data_len:0,exportJsonLoading:!1,exportCsvLoading:!1,dropTableLoading:!1,export_csv:"",export_json:"",showsql:!1,showmoni:!0,tableData:[],table_structure:"",table_define_display:!1,dataEngines:[],form:{sqlScript:"",url:"",head:[{name:"INTEGER",value:"id"}],sqlTableMeta:[],sqlTableindexes:[]},formRules:{url:[{required:!0,message:"请选择数据引擎",trigger:"blur"}],sqlScript:[{required:!0,message:"请输入脚本",trigger:"blur"}]},all_predict_btn:"All (0)",errors_btn:"Errors (0)",modelPredictions:[],transferX:"",processtag:"",p_type:"list",delName:"",delTitle:"删除文件/目录",tobeDelFileDir:"",tobeDelFileDirType:"",delFileDirVisible:!1,delFileDirLoading:!1,editFileNameLoading:!1,editFileNameFormVisible:!1,editFileNameFormRules:{newName:[{required:!0,message:"请输入名称",trigger:"blur"}]},editFileNameForm:{newName:""},oldName:"",fileList:[],uploadURL:l["I"]+"/api/models/upload_model_files",lookdir:!0,lookfilecontent:!1,is_dir:"",file_content:"",cur_path:"",files:[],curr_stage_style:"",stag_act1_style:"",stag_act2_style:"",stag_act3_style:"",stag_act1:"",stag_act2:"",stag_act3:"",modelversions:[],isall:"all",regedModelVersion:{},descvisalble:!0,descEditable:!1,campaignMeta:{},editModelVersionMeta:{description:""},activeNames:["1","2","3"],firstID:"all",altListData:[],moment:d.a,project:"",case:"",AbExpList:[],listLoading:!1,listLoadingMonitor:!1,filters:{name:""},total:0,page:1,page_pred:1,moni_page:1,total_pred:0,moni_total:0,sels:[],activeIndex:""}},filters:{formatDate:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;var i=t.getDate();i=i<10?"0"+i:i;var o=t.getHours();o=o<10?"0"+o:o;var l=t.getMinutes();l=l<10?"0"+l:l;var n=t.getSeconds();return n=n<10?"0"+n:n,a+"-"+s+"-"+i+" "+o+":"+l+":"+n}},computed:{tableSelected:function(){return this.mltable},dataSelected:function(){return this.Xlable,this.Ylable}},watch:{dataSelected:function(){var e=this;console.log(this.Xlable,this.tableData,"Xval2"),console.log(this.Ylable,"Yval2"),this.legendY=[],this.dataX=[],this.dataY=[],this.Xlable.forEach((function(t){e.tableData.forEach((function(a){e.dataX.push(a[t])}))})),this.Ylable.forEach((function(t){e.legendY.push(e.tableHeader[t][0])})),this.Ylable.forEach((function(t,a){var s=[];e.tableData.forEach((function(e){s.push(e[t])})),e.dataY.push({name:e.tableHeader[t][0],type:"line",data:s})})),console.log(this.legendY,this.dataX,this.dataY),this.drawLine()},isall:function(){"sql"===this.isall?(this.showsql=!0,this.showmoni=!1):(this.showsql=!1,this.showmoni=!0),this.getpredInfo(this.isall),console.log(this.isall,this.showsql,"isall")},tableSelected:function(e){this.changeTable(e)}},methods:{FormatSqlScript:function(){var e=this;r.a.ajax({type:"post",url:l["I"]+"/api/models/format_sql_script",async:!0,data:JSON.stringify({model_name:this.$route.params.model_name,version_id:this.$route.params.version_id,sql_script:this.form.sqlScript,user_name:JSON.parse(sessionStorage.getItem("name"))}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.form.sqlScript=t.data.formatedsql,console.log("format sql script success")}})},sqlSave:function(){this.saveSqlScript(this.form.sqlScript)},saveSqlScript:function(e){var t=this,a=this.$createElement,s="";this.$msgbox({title:"Save inquiry",message:a("div",null,[a("input",{domProps:{type:"text",value:s,placeholder:"请输入名称"},class:{"el-input__inner":!0},on:{change:function(e){s=e.target.value}}})]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,i,o){"confirm"===a?(i.confirmButtonLoading=!0,i.confirmButtonText="保存中...",console.log(s,"name"),setTimeout((function(){t.saveScript(s,e),o(),setTimeout((function(){i.confirmButtonLoading=!1}),30)}),400)):o()}}).then((function(e){t.$message({type:"success",message:"查询语句保存成功"})}))},drawLine:function(){var e,t=document.getElementById("tester"),a=o["a"](t);a.clear(),e={title:{text:"模型监控",textStyle:{color:"#ccc",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:15},subtext:this.regedModelVersion.name+": Version "+this.regedModelVersion.version,subtextStyle:{}},tooltip:{trigger:"axis"},legend:{data:this.legendY},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{readOnly:!1},magicType:{type:["line","bar","stack","tiled"]},restore:{},saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:this.dataX},yAxis:{type:"value"},series:this.dataY},e&&a.setOption(e)},changeTable:function(e){console.log(e,"table"),this.tableName=e,this.getTableStructure()},handleCommandDownload:function(e){"json"===e?(this.exportJsonLoading=!0,this.ExportJson()):(this.exportCsvLoading=!0,this.ExportCsv())},DropTable:function(){var e=this,t=this;this.$confirm("确认删除表吗？","提示",{}).then((function(){e.dropTableLoading=!0;var a=JSON.stringify({model_name:e.$route.params.model_name,version_id:e.$route.params.version_id,table_name:e.tableName});r.a.ajax({type:"POST",url:l["I"]+"/api/sql/drop_table",async:!0,data:a,headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){t.dropTableLoading=!1,"999999"===e.code?(t.getTableStructure(),t.$message.success({message:"表删除成功！",center:!0})):t.$message.error({message:e.msg,center:!0})}})}))},ExportCsv:function(){this.export_json="",this.export_csv="1",this.DownloadQuery()},ExportJson:function(){this.export_json="1",this.export_csv="",this.DownloadQuery()},DownloadQuery:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.export_json?e.exportJsonLoading=!0:e.exportCsvLoading=!0;var a=e,s=JSON.stringify({model_name:e.$route.params.model_name,version_id:a.$route.params.version_id,sqlScript:e.form.sqlScript,table_name:e.tableName,exportJson:e.export_json,exportCsv:e.export_csv,page:a.moni_page});console.log(s,"sqlScript"),r.a.ajax({type:"POST",url:l["I"]+"/api/sql/sql_script_excute",async:!0,data:s,responseType:"blob",headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){if(e.export_json?e.exportJsonLoading=!1:e.exportCsvLoading=!1,e.export_json){var a=new Blob([t],{type:"application/json;"}),s=document.createElement("a"),i=URL.createObjectURL(a);s.setAttribute("href",i),s.setAttribute("download","export_query.json"),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}else{var o=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),n=URL.createObjectURL(o);l.setAttribute("href",n),l.setAttribute("download","export_query.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}})}}))},getTableStructure:function(){var e=this,t=this;r.a.ajax({type:"get",url:l["I"]+"/api/sql/table_structure",async:!0,data:{model_name:this.$route.params.model_name,version_id:t.$route.params.version_id,table_name:this.tableName},headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(a){"999999"===a.code?(t.table_structure=a.data.data,t.form.sqlTableMeta=a.data.columns,t.indexedColumnsOptions=a.data.columns,t.form.sqlTableindexes=a.data.indexes,t.form.sqlScript=a.data.defaultSql,t.dataEngines=a.data.tables,e.tableName=a.data.tableName,e.mltable=e.tableName,console.log(t.indexedColumnsOptions,"indexedColumnsOptions"),console.log(t.table_structure,"table_structure"),e.uploadParam={project_id:e.$route.params.project_id,table_name:e.tableName}):t.$message.error({message:a.msg,center:!0})}})},sqlExecute:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.sqlScriptSend=!0;var a=e;a.form.statusCode="",a.form.resultData="",a.form.resultHead="";var s=JSON.stringify({model_name:e.$route.params.model_name,version_id:a.$route.params.version_id,sqlScript:e.form.sqlScript,table_name:e.tableName,exportJson:"",exportCsv:"",page:a.moni_page});console.log(s,"sqlScript"),r.a.ajax({type:"POST",url:l["I"]+"/api/sql/sql_script_excute",async:!0,data:s,responseType:"blob",headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){a.sqlScriptSend=!1,a.afterrun=!0,"999999"===e.code?(a.Xs=[],a.Ys=[],a.legendY=[],a.dataX=[],a.dataY=[],a.tableHeader=e.data.tableHeader,a.moni_total=e.data.query_data_len,a.tableData=e.data.tableData,a.form.sqlScript=e.data.defaultSql,a.query_data_len=e.data.query_data_len,e.data.tableHeader.forEach((function(e,t){a.Xs.push({value:t,label:e[0]})})),e.data.tableHeader.forEach((function(e,t){a.Ys.push({value:t,label:e[0]})})),console.log(a.X,"self.x"),console.log(a.tableHeader,"self.tableHeader"),console.log(a.tableData,"self.tableData")):a.$message.error({message:e.msg,center:!0})}})}}))},PlotMonitorData:function(){this.monitorPlotShow?this.monitorPlotShow=!1:(this.monitorPlotShow=!0,this.drawLine())},tableDefine:function(){this.table_define_display?this.table_define_display=!1:(this.table_define_display=!0,this.getTableStructure())},getMonitorInfo:function(e){var t=this,a={user_name:JSON.parse(sessionStorage.getItem("name")),version_id:this.$route.params.version_id,name:this.$route.params.model_name};console.log(a,"paraar");var s={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["B"])(s,a).then((function(e){t.listLoading=!1;var a=e.msg,s=e.code,i=e.data;"999999"===s?(t.all_predict_cnt=i.all_predict_cnt,t.errors_cnt=i.errors_cnt,t.all_predict_btn="All ("+t.all_predict_cnt+")",t.errors_btn="Errors ("+t.errors_cnt+")",console.log(t.all_predict_cnt,"self.all_predict_cnt")):t.$message.error({message:a,center:!0})}))},getpredInfo:function(e){var t=this;t.listLoadingMonitor=!0;var a={user_name:JSON.parse(sessionStorage.getItem("name")),version_id:this.$route.params.version_id,name:this.$route.params.model_name,process_btn:e,page_pred:this.page_pred};console.log(a,"paraar");var s={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["C"])(s,a).then((function(e){t.listLoadingMonitor=!1;var a=e.msg,s=e.code,i=e.data;"999999"===s?(t.modelPredictions=i.data,t.total_pred=i.total,console.log(t.modelPredictions,"self.modelPredictions")):t.$message.error({message:a,center:!0})}))},open:function(e,t,a){var s=this,i=this.$createElement;this.$msgbox({title:"Stage Transition",message:i("div",null,[i("span",null,"Transition to "),i("i",{style:"color: teal",class:"el-icon-right"}),i("strong",null," "),i("span",{class:e},[i("strong",null,a)])]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(e,a,i){"confirm"===e?(a.confirmButtonLoading=!0,a.confirmButtonText="转换中...",setTimeout((function(){i(),s.transformModelStagef(t),setTimeout((function(){a.confirmButtonLoading=!1}),30)}),300)):i()}}).then((function(e){s.$message({type:"success",message:"模型状态转换成功"})}))},catFileContents:function(e,t){var a=this,s=this,i={model_name:this.$route.params.model_name,version_id:this.$route.params.version_id,path:e,filename:t,p_type:"cat",is_subdirectory:this.is_subdirectory,user_name:JSON.parse(sessionStorage.getItem("name"))},o={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["n"])(o,i).then((function(e){var t=e.msg,i=e.code,o=e.data;"999999"===i?(s.total=o.total,s.is_subdirectory=o.is_subdirectory,s.directory=o.directory,s.back=o.back,s._code=o.code,s.file_content=o.file_content,s.is_dir=!1,a.back_display="float:right",console.log(o,"self.file_content")):s.$message.error({message:t,center:!0})}))},delFileDirSubmit:function(){var e=this,t=!0;if(t){var a=this;this.$confirm("确认提交吗？","提示",{}).then((function(){a.delFileDirLoading=!0,r.a.ajax({type:"post",url:l["I"]+"/api/modelfile/del_file_dir",async:!0,data:JSON.stringify({name:e.delName,tobeDelFileDirType:e.tobeDelFileDirType,path:e.directory}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){a.delFileDirLoading=!1,"999999"===e.code?(a.delFileDirVisible=!1,a.$message({message:"删除成功",center:!0,type:"success"}),a.getFileDir()):(a.delFileDirVisible=!1,a.$message.error({message:e.msg,center:!0}))}})}))}},handleDelFileDir:function(e,t){this.delFileDirVisible=!0,this.delName=t,e?(this.tobeDelFileDirType="dir",this.delTitle="删除目录",this.tobeDelFileDir="您确定要删除目录："+t+"？"):(this.tobeDelFileDirType="file",this.delTitle="删除文件",this.tobeDelFileDir="您确定要删除文件："+t+"？")},submitUpload:function(){console.log(this.directory,"directory"),this.$refs.upload.submit()},editFileNameSubmit:function(){var e=this;this.$refs.editFileNameForm.validate((function(t){if(t){var a=e;e.$confirm("确认提交吗？","提示",{}).then((function(){a.editFileNameLoading=!0,r.a.ajax({type:"post",url:l["I"]+"/api/modelfile/rename_file_dir_name",async:!0,data:JSON.stringify({project_id:Number(e.$route.params.project_id),name:e.editFileNameForm.newName,old_name:e.oldName,path:e.directory}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){a.editFileNameLoading=!1,"999999"===e.code?(a.editFileNameFormVisible=!1,a.$message({message:"修改成功",center:!0,type:"success"}),a.getFileDir()):(a.editFileNameFormVisible=!1,a.$message.error({message:e.msg,center:!0}))}})}))}}))},handleEditFileName:function(e,t){this.rename_tile_type=e?"重命名目录:"+t:"重命名文件:"+t,this.oldName=t,this.editFileNameFormVisible=!0,this.editFileNameForm.newName=t},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleUploadSuccess:function(e,t,a){"999999"===e.code?(this.getFileDir(),this.$message({message:"上传成功",center:!0,type:"success"})):this.$message.error({message:"上传失败",center:!0})},_back:function(){var e=this;this.is_dir?this.cur_path=e.rel_path:(console.log(this.cur_path,"this.cur_pathback"),this.cur_path=e.back),this.lookfilecontent=!1,this.lookdir=!0,e.getFileDir()},handleFileDir:function(e,t){console.log("handleFileDir",t),this.cur_path=t.rel_path,this.is_dir=t.is_dir,t.is_dir||(this.back_display="float:right",this.lookfilecontent=!0,this.lookdir=!1,this.p_type="cat"),this.getFileDir()},handleCatFileName:function(e,t){this.lookfilecontent=!0,this.lookdir=!1,console.log(t,"handleCatFileName"),this.file_content="",this.catFileContents(t.rel_path,t.name)},saveScript:function(e,t){r.a.ajax({type:"post",url:l["I"]+"/api/models/save_sql_script",async:!0,data:JSON.stringify({model_name:this.$route.params.model_name,version_id:this.$route.params.version_id,name:e,sql_script:t,user_name:JSON.parse(sessionStorage.getItem("name"))}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){console.log("save sql script success")}})},transferJupyter:function(){var e=this;r.a.ajax({type:"post",url:l["I"]+"/api/models/get_models_markdown",async:!0,data:JSON.stringify({model_name:this.$route.params.model_name,version_id:this.$route.params.version_id,user_name:JSON.parse(sessionStorage.getItem("name"))}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.getFileDir()}})},getFileDir:function(){this.listLoading=!0;var e=this;r.a.ajax({type:"get",url:l["I"]+"/api/models/get_model_files",async:!0,data:{model_name:this.$route.params.model_name,page:Number(e.page),is_dir:e.is_dir,version_id:this.$route.params.version_id,path:e.cur_path,p_type:e.p_type},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.listLoading=!1,"999999"===t.code?(e.total=t.data.total,e.is_subdirectory=t.data.is_subdirectory,e.directory=t.data.directory,e.back=t.data.back,e._code=t.data.code,e.files=t.data.files,e.pathParam={pathParam:e.directory},e.is_subdirectory?e.back_display="float:right":e.back_display="display:none",console.log(t,"data")):e.$message.error({message:"data.msg",center:!0})}})},handleStageStyle:function(e){"Production"===e?(this.curr_stage_style="success",this.stag_act1_style="warning",this.stag_act1="Staging",this.stag_act2_style="info",this.stag_act2="None",this.stag_act3_style="info",this.stag_act3="Archived"):"Staging"===e?(this.curr_stage_style="warning",this.stag_act1_style="info",this.stag_act1="Archived",this.stag_act2_style="info",this.stag_act2="None",this.stag_act3_style="success",this.stag_act3="Production"):"None"===e?(this.curr_stage_style="info",this.stag_act1_style="info",this.stag_act1="Archived",this.stag_act2_style="warning",this.stag_act2="Staging",this.stag_act3_style="success",this.stag_act3="Production"):(this.curr_stage_style="info",this.stag_act1_style="info",this.stag_act1="None",this.stag_act2_style="warning",this.stag_act2="Staging",this.stag_act3_style="success",this.stag_act3="Production")},handleCommand:function(e){console.log(e,"command"),this.transferX="Production"===e?"el-tag el-tag--success el-tag--small el-tag--light":"Staging"===e?"el-tag el-tag--warning el-tag--small el-tag--light":"el-tag el-tag--info el-tag--small el-tag--light";var t=e;this.open(this.transferX,e,t)},transformModelStagef:function(e){var t=this,a=this,s=JSON.stringify({model_name:this.$route.params.model_name,stage:e,version:this.$route.params.version_id,user_name:JSON.parse(sessionStorage.getItem("name"))});console.log(s,"params");var i={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["J"])(i,s).then((function(e){var s=e.msg,i=e.code;"999999"===i?t.getModelsVersionMetaData():"999997"===i?a.$message.error({message:s,center:!0}):(a.$message.error({message:s,center:!0}),t.getModelsVersionMetaData())}))},getModelsVersionMetaData:function(){var e=this,t=this,a={user_key:JSON.parse(sessionStorage.getItem("name")),name:this.$route.params.model_name,version:this.$route.params.version_id},s={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["z"])(s,a).then((function(a){var s=a.msg,i=a.code,o=a.data;"999999"===i?(t.regedModelVersion=o,e.handleStageStyle(o.current_stage),""===e.regedModelVersion.description&&(e.regedModelVersion.description="无"),console.log(t.regedModelVersion,"self.regedModelVersion")):t.$message.error({message:s,center:!0})}))},submitSave:function(){var e=this,t=this,a=JSON.stringify({model_name:t.$route.params.model_name,version:t.$route.params.version_id,description:t.editModelVersionMeta.description,user_name:JSON.parse(sessionStorage.getItem("name"))});console.log(a,"params");var s={"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))};Object(l["f"])(s,a).then((function(a){var s=a.msg,i=a.code;"999999"===i?(t.$message({message:"添加成功",center:!0,type:"success"}),e.descEditable=!1,e.descvisalble=!0,e.editModelVersionMeta.description="",t.getModelsVersionMetaData()):"999997"===i?t.$message.error({message:s,center:!0}):(t.$message.error({message:s,center:!0}),e.editModelVersionMeta.description="",e.descEditable=!1,e.descvisalble=!0,t.getModelsVersionMetaData())}))},handelCancel:function(){this.descEditable=!1,this.descvisalble=!0,this.editModelVersionMeta.description=""},handleEdit:function(){this.descEditable=!0,this.descvisalble=!1,this.editModelVersionMeta.description=this.regedModelVersion.description},handleChange:function(e){console.log(e)},handleCurrentChange:function(e){this.page=e,this.getFileDir()},handleCurrentChange2:function(e){this.page_pred=e,this.getpredInfo(this.isall)}},created:function(){console.log(this.Xvalue1,"Xval")},mounted:function(){this.getModelsVersionMetaData(),this.getFileDir(),this.getpredInfo("all"),this.getMonitorInfo(),this.getTableStructure()}},p=m,u=(a("d83e"),a("2877")),g=Object(u["a"])(p,s,i,!1,null,"15d9e167",null);t["default"]=g.exports},d83e:function(e,t,a){"use strict";a("33a1")}}]);
//# sourceMappingURL=chunk-f35ed682.e583b07b.js.map